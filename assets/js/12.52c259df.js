(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{379:function(s,t,a){"use strict";a.r(t);var n=a(45),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"pytorch-加载图片"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pytorch-加载图片"}},[s._v("#")]),s._v(" pytorch 加载图片")]),s._v(" "),a("p",[s._v("使用pytorch制作图像数据集时，需要将存储在磁盘、硬盘的图像读取到内存中，涉及到图像I/O问题。")]),s._v(" "),a("p",[s._v("在python中，图像处理主要采用的库："),a("strong",[s._v("skimage, opencv-python, Pillow (PIL)")]),s._v("。 这三个库均提供了图像读取的方法。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("库")]),s._v(" "),a("th",[s._v("方法")]),s._v(" "),a("th",[s._v("返回值")]),s._v(" "),a("th",[s._v("图像像素格式")]),s._v(" "),a("th",[s._v("像素值范围")]),s._v(" "),a("th",[s._v("图像矩阵表示")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("skimage")]),s._v(" "),a("td",[s._v("o.imread(path)")]),s._v(" "),a("td",[s._v("numpy.ndarray")]),s._v(" "),a("td",[s._v("RGB")]),s._v(" "),a("td",[s._v("[0, 255]")]),s._v(" "),a("td",[s._v("(H X W X C)")])]),s._v(" "),a("tr",[a("td",[s._v("cv2")]),s._v(" "),a("td",[s._v("cv2.imread(path)")]),s._v(" "),a("td",[s._v("numpy.ndarray")]),s._v(" "),a("td",[s._v("BGR")]),s._v(" "),a("td",[s._v("[0, 255]")]),s._v(" "),a("td",[s._v("(H X W X C)")])]),s._v(" "),a("tr",[a("td",[s._v("Pillow(PIL)")]),s._v(" "),a("td",[s._v("Image.open(path)")]),s._v(" "),a("td",[s._v("PIL.Image.Image对象")]),s._v(" "),a("td",[s._v("根据图像格式，一般为RGB")]),s._v(" "),a("td",[s._v("[0, 255]")]),s._v(" "),a("td",[s._v("—")])])])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" matplotlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyplot "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" plt\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" skimage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" io\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" cv2\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" PIL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Image\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" numpy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" np\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dog.jpg    width = 1599, height=1066, channel=3")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用skimage读取图像")]),s._v("\nimg_skimage "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("imread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dog.jpg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# skimage.io imread()-----np.ndarray,  (H x W x C), [0, 255],RGB")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("img_skimage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shape"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用opencv读取图像")]),s._v("\nimg_cv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cv2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("imread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dog.jpg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cv2.imread()------np.array, (H x W xC), [0, 255], BGR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("img_cv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shape"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用PIL读取")]),s._v("\nimg_pil "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dog.jpg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# PIL.Image.Image对象")]),s._v("\nimg_pil_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("img_pil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (H x W x C), [0, 255], RGB")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("img_pil_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shape"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nplt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("figure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" im "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("enumerate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("img_skimage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" img_cv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" img_pil_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    ax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subplot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    ax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("imshow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("im"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pause"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h2",{attrs:{id:"tensorboard使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tensorboard使用"}},[s._v("#")]),s._v(" Tensorboard使用")]),s._v(" "),a("blockquote",[a("p",[s._v("在训练神经网络时，我们希望能更直观地了解训练情况，包括损失曲线、输入图片、输出图片、卷积核的参数分布等信息。这些信息能帮助我们更好地监督网络的训练过程，并为参数优化提供方向和依据。最简单的办法就是打印输出，但其只能打印数值信息，不够直观，同时无法查看分布、图片、声音等。接下来，将介绍两个深度学习中常用的可视化工具之一：Tensorboard。")])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("utils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tensorboard "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" SummaryWriter\n\n\n tensorboard "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logdir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("logs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6007")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"图像变换-transform的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图像变换-transform的使用"}},[s._v("#")]),s._v(" 图像变换，transform的使用")]),s._v(" "),a("h3",{attrs:{id:"_1-transform-resize-图像尺寸变换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-transform-resize-图像尺寸变换"}},[s._v("#")]),s._v(" 1. transform.Resize() 图像尺寸变换")]),s._v(" "),a("p",[a("strong",[s._v("调整PILImage对象的尺寸")]),s._v("，注意不能是用"),a("code",[s._v("io.imread")]),s._v("或者"),a("code",[s._v("cv2.imread")]),s._v("读取的图片，这两种方法得到的是"),a("code",[s._v("ndarray")]),s._v("。")]),s._v(" "),a("p",[s._v("将图片短边缩放至x，长宽比保持不变：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("transforms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Resize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("而一般输入深度网络的特征图长宽是相等的，就不能采取等比例缩放的方式了，需要同时指定长宽：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("transforms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Resize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" w"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("这样虽然会改变图片的长宽比，"),a("strong",[s._v("但是本身并没有发生裁切")]),s._v("，仍可以通过resize方法返回原来的形状：")])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" PIL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Image\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" torchvision "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" transforms\n\nimg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.jpg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n w"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" h "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("size\n    \nresize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" transforms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Resize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("224")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("244")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nimg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nimg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2.jpg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nresize2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" transforms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Resize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" w"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nimg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resize2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nimg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.jpg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("原始图 500*399")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/ChetWei/img/raw/master/img/202109211044197.png",alt:"image-20210921104412025"}})]),s._v(" "),a("p",[s._v("转换后的图 224*224")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/ChetWei/img/raw/master/img/202109211044228.png",alt:"image-20210921104447165"}})]),s._v(" "),a("blockquote",[a("p",[s._v("需要注意的一点是PILImage对象size属性返回的是w, h，而resize的参数顺序是h, w。")])]),s._v(" "),a("h3",{attrs:{id:"_2-transforms-normalize-数据标准化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-transforms-normalize-数据标准化"}},[s._v("#")]),s._v(" 2.transforms.normalize() 数据标准化")]),s._v(" "),a("blockquote",[a("p",[s._v("功能：逐channel的对图像进行标准化（均值变为0，标准差变为1），可以加快模型的收敛\noutput = (input - mean) / std\nmean:各通道的均值\nstd：各通道的标准差\ninplace：是否原地操作")]),s._v(" "),a("p",[s._v("思考：\n（1）据我所知，归一化就是要把图片3个通道中的数据整理到[-1, 1]区间。\nx = (x - mean(x))/std(x)\n只要输入数据集x确定了，mean(x)和std(x)也就是确定的数值了，为什么Normalize()函数还需要输入mean和std的数值呢？？？？")]),s._v(" "),a("p",[s._v("（2）RGB单个通道的值是[0, 255]，所以一个通道的均值应该在127附近才对。\n如果Normalize()函数去计算 x = (x - mean)/std ，因为RGB是[0, 255]，算出来的x就不可能落在[-1, 1]区间了。")]),s._v(" "),a("p",[s._v("（3）在我看的了论文代码里面是这样的：\ntorchvision.transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\n为什么就确定了这一组数值，这一组数值是怎么来的？ 为什么这三个通道的均值都是小于1的值呢？")]),s._v(" "),a("p",[s._v("理解：\n（1）针对第一个问题，mean 和 std 肯定要在normalize（）之前自己先算好再传进去的，不然每次normalize（）就得把所有的图片都读取一遍算这两个\n（2）针对第二个问题，有两种情况\n（a )如果是imagenet数据集，那么ImageNet的数据在加载的时候就已经转换成了[0, 1].\n（b) 应用了torchvision.transforms.ToTensor，其作用是将数据归一化到[0,1]（是将数据除以255），transforms.ToTensor（）会把HWC会变成C *H *W（拓展：格式为(h,w,c)，像素顺序为RGB）\n（3）针对第三个问题：[0.485, 0.456, 0.406]这一组平均值是从imagenet训练集中抽样算出来的。\n继续有疑问：\nToTensor 已经[0,1]为什么还要[0.485, 0.456, 0.406]？那么归一化后为什么还要接一个Normalize()呢?Normalize()是对数据按通道进行标准化，即减去均值，再除以方差")])]),s._v(" "),a("h4",{attrs:{id:"训练好网络模型的保存和加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#训练好网络模型的保存和加载"}},[s._v("#")]),s._v(" 训练好网络模型的保存和加载")]),s._v(" "),a("h5",{attrs:{id:"只保存和加载模型参数-推荐使用-但需要重新模型结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#只保存和加载模型参数-推荐使用-但需要重新模型结构"}},[s._v("#")]),s._v(" 只保存和加载模型参数（推荐使用，但需要重新模型结构）")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#保存模型")]),s._v("\ntorch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("the_model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#提取模型")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#需要先重新模型结构")]),s._v("\nthe_model "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TheModelClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("kwargs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#再加载参数")]),s._v("\nthe_model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load_state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h5",{attrs:{id:"保存和加载整个模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保存和加载整个模型"}},[s._v("#")]),s._v(" 保存和加载整个模型")]),s._v(" "),a("p",[s._v("如下会保存整个网络，如果数据量比较大，会消耗大量时间。占用的内存也比较高，所以不推荐使用")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存")]),s._v("\ntorch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("the_model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提取")]),s._v("\nthe_model "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"损失函数的选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#损失函数的选择"}},[s._v("#")]),s._v(" 损失函数的选择")]),s._v(" "),a("h4",{attrs:{id:"优化器的选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化器的选择"}},[s._v("#")]),s._v(" 优化器的选择")]),s._v(" "),a("h4",{attrs:{id:"tqdm-进度条库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tqdm-进度条库"}},[s._v("#")]),s._v(" tqdm 进度条库")])])}),[],!1,null,null,null);t.default=e.exports}}]);